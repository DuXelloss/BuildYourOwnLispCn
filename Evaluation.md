第零七章 • 计算

## 树型结构

现在，我们可以读取输入，解析并得到表达式的内部结构。但是，我们并不能对这个表达式进行计算。本章我们将编写代码，对内部结构进行计算求值。

所谓的内部结构就是上一章中打印出来的内容。它被称为*抽象语法树*(Abstract Syntax Tree，简称 AST)。它用来表示用户输入的表达式的结构。操作数和操作符等需要被处理的实际数据都位于叶子节点上。而非叶子节点的分支上则包含了遍历和求值的信息。

在做解析和求值之前，我们先来看一下数据结构具体的内部表示：

```c
typedef struct mpc_ast_t {
  char* tag;
  char* contents;
  mpc_state_t state;
  int children_num;
  struct mpc_ast_t** children;
} mpc_ast_t;
```

下面我们来逐一的看看结构体各个字段的含义。

第一个为 `tag` 字段。当我们打印这个树形结构时，`tag` 就是在节点内容之前的信息，它表示了解析节点时所用到的规则。例如：`expr|number|regex`。

